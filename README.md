Regarding the solution for P1: Iterate using P1-step1 and P1-step2 to obtain the accessibility time of the damaged node. Then, pass the obtained accessibility time of the damaged node to P1-step3 to obtain the resource distribution completion time.

P2 is solved directly.
